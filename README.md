# prosoft-artifact-archiver
Скрипт для архивации артефактов проекта

## Скрипты и файлы

| Файл                       | Описание                                                     |
|----------------------------|--------------------------------------------------------------|
| `Get-Archive.ps1`      | Скрипт для архивирования артефактов и создания хэш-сумм.    |
| `Get-Archive.Tests.ps1` | Тесты Pester для проверки функциональности.                 |
| `create_structure.ps1` | Скрипт для создания структуры директорий *dev_build*.       |
| `remove_structure.ps1` | Скрипт для удаления структуры директорий *dev_build*.       |
| `justfile`              | Набор команд для *just* (управляющего инструмента для автоматизации задач). |
| `Dockerfile`           | Файл для создания Docker-образа, подходящего для проведения тестов скриптов. Включает все необходимые зависимости. |

## GitHub Actions

| Файл                       | Описание                                                     |
|----------------------------|--------------------------------------------------------------|
| `test-workflow.yml` | Файл автоматизации проверки скриптов. Запускается на контейнере demisto/powershell. |
| `Build-Docker-and-test.yaml` | Файл автоматизации проверки скриптов. Создает контейнер из собственного Dockerfile на основе Alpine.|
| `test-workflow-windows.yaml` | Файл автоматизации проверки скриптов. Проверяет работоспособность скрипта в Windows. |


## Задание

Кратко: пишем скрипт, покрываем тестами, публикуем, автоматизируем его проверку.

Результат тестового должен быть опубликован как отдельный GitHub репозиторий с публичным доступом.

### Дано

В результате сборки проекта у вас получилась следующая структура директорий:

```
➜  devops_test: tree dev_build
dev_build
├── grpedit
│   ├── distr.deb
│   ├── syms.7z
│   └── tests
│       ├── test_reports.txt.7z
│       └── test_reports.xunit.7z
├── modservice
│   ├── distr.deb
│   ├── syms.7z
│   └── tests
│       ├── test_reports.txt.7z
│       └── test_reports.xunit.7z
├── rsysconf
│   ├── distr.deb
│   ├── syms.7z
│   └── tests
│       ├── test_reports.txt.7z
│       └── test_reports.xunit.7z
└── scada
    ├── distr.deb
    ├── syms.7z
    └── tests
        ├── test_reports.txt.7z
        └── test_reports.xunit.7z

9 directories, 16 files

```

Здесь  dev_build корневая директория артефактов, в котором для каждого проекта существует своя поддиректория (grpedit, modservice, rsysconf, scada). Кол-во и названия проектов могут быть любыми.

### 1. Автоматизируем

Требуется для каждого проекта создавать 7z-архив со всеми его артефактами.
Для чего написать скрипт на Powershell версии 7+. Скрипт должен работать на Windows и Linux.
Название архива должно формироваться по шаблону "<имя проекта>\_artifacts.7z"
В архиве также должны лежать файлы md5sums.txt и sha1sums.txt и sha256sums.txt содержащие хэш-суммы всего содержимого архива.
Для каждого созданного архива требуется аналогично создать файлы с хэш-суммой самого архива по шаблону "<полное имя архива>.<алгоритм хэширования>". Например, "grpedit_artifacts.7z.md5"

Для решения указать его ограничения и недостатки, если такие известны.

### 2. Убеждаемся, что не накосячили

Для написанного скрипта написать набор тестов используя Powershell Pester.

### 3. Упрощаем себе жизнь

Используя Makefile или just (https://github.com/casey/just) сохранить команды запуска скрипта и запуска тестов.

### 4. Автоматизируем проверки

Создать Docker-образ подходящий для проведения тестов скрипта. Используя GitHub Actions автоматизировать запуск тестов скрипта
